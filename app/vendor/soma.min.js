/*! grunt 2014-01-05 */

!function(a){"use strict";a.version="0.6.9";var b=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,c=/,/,d=/^\s*(_?)(\S+?)\1\s*$/,e=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;Array.prototype.contains||(Array.prototype.contains=function(a){for(var b=this.length;b--;)if(this[b]===a)return!0;return!1}),a.InjectorError={MAPPING_BAD_PROP:"[Error infuse.Injector.mapClass/mapValue] the first parameter is invalid, a string is expected",MAPPING_BAD_VALUE:"[Error infuse.Injector.mapClass/mapValue] the second parameter is invalid, it can't null or undefined, with property: ",MAPPING_BAD_CLASS:"[Error infuse.Injector.mapClass/mapValue] the second parameter is invalid, a function is expected, with property: ",MAPPING_BAD_SINGLETON:"[Error infuse.Injector.mapClass] the third parameter is invalid, a boolean is expected, with property: ",MAPPING_ALREADY_EXISTS:"[Error infuse.Injector.mapClass/mapValue] this mapping already exists, with property: ",CREATE_INSTANCE_INVALID_PARAM:"[Error infuse.Injector.createInstance] invalid parameter, a function is expected",NO_MAPPING_FOUND:"[Error infuse.Injector.getInstance] no mapping found",INJECT_INSTANCE_IN_ITSELF_PROPERTY:"[Error infuse.Injector.getInjectedValue] A matching property has been found in the target, you can't inject an instance in itself",INJECT_INSTANCE_IN_ITSELF_CONSTRUCTOR:"[Error infuse.Injector.getInjectedValue] A matching constructor parameter has been found in the target, you can't inject an instance in itself"};var f=function(a,b,c,d){this.prop=a,this.value=b,this.cl=c,this.singleton=d||!1},g=function(b){if("string"!=typeof b)throw new Error(a.InjectorError.MAPPING_BAD_PROP)},h=function(b,c){if(void 0===c||null===c)throw new Error(a.InjectorError.MAPPING_BAD_VALUE+b)},i=function(b,c){if("function"!=typeof c)throw new Error(a.InjectorError.MAPPING_BAD_CLASS+b)},j=function(b,c){if("boolean"!=typeof c)throw new Error(a.InjectorError.MAPPING_BAD_SINGLETON+b)},k=function(b,c){var d=a.getConstructorParams(c);if(d.contains(b))throw new Error(a.InjectorError.INJECT_INSTANCE_IN_ITSELF_CONSTRUCTOR)},l=function(b,c){if(c.hasOwnProperty(b))throw new Error(a.InjectorError.INJECT_INSTANCE_IN_ITSELF_PROPERTY)};a.Injector=function(){this.mappings={},this.parent=null},a.getConstructorParams=function(a){function f(a,b,c){g.push(c)}for(var g=[],h=a.toString().replace(e,""),i=h.match(b),j=i[1].split(c),k=0;k<j.length;k++){var l=j[k];l.replace(d,f)}return g},a.Injector.prototype={createChild:function(){var b=new a.Injector;return b.parent=this,b},getMappingVo:function(a){return this.mappings?this.mappings[a]?this.mappings[a]:this.parent?this.parent.getMappingVo(a):null:null},mapValue:function(b,c){if(this.mappings[b])throw new Error(a.InjectorError.MAPPING_ALREADY_EXISTS+b);return g(b),h(b,c),this.mappings[b]=new f(b,c,void 0,void 0),this},mapClass:function(b,c,d){if(this.mappings[b])throw new Error(a.InjectorError.MAPPING_ALREADY_EXISTS+b);return g(b),i(b,c),d&&j(b,d),this.mappings[b]=new f(b,null,c,d),this},removeMapping:function(a){return this.mappings[a]=null,delete this.mappings[a],this},hasMapping:function(a){return!!this.mappings[a]},hasInheritedMapping:function(a){return!!this.getMappingVo(a)},getMapping:function(a){for(var b in this.mappings)if(this.mappings.hasOwnProperty(b)){var c=this.mappings[b];if(c.value===a||c.cl===a)return c.prop}return void 0},getValue:function(b){var c=this.mappings[b];if(!c){if(this.parent)return this.parent.getValue.apply(this.parent,arguments);throw new Error(a.InjectorError.NO_MAPPING_FOUND)}if(c.cl){var d=Array.prototype.slice.call(arguments);return d[0]=c.cl,c.singleton?(c.value||(c.value=this.createInstance.apply(this,d)),c.value):this.createInstance.apply(this,d)}return c.value},getClass:function(a){var b=this.mappings[a];return b?b.cl?b.cl:void 0:this.parent?this.parent.getClass(a):void 0},instantiate:function(b){if("function"!=typeof b)throw new Error(a.InjectorError.CREATE_INSTANCE_INVALID_PARAM);for(var c=[null],d=a.getConstructorParams(b),e=0;e<d.length;e++)if(void 0!==arguments[e+1]&&null!==arguments[e+1])c.push(arguments[e+1]);else{var f=d[e],g=this.getMappingVo(f);if(g){var h=this.getInjectedValue(g,f);c.push(h)}else c.push(void 0)}return new(Function.prototype.bind.apply(b,c))},inject:function(a,b){this.parent&&this.parent.inject(a,!0);for(var c in this.mappings)if(this.mappings.hasOwnProperty(c)){var d=this.getMappingVo(c);(a.hasOwnProperty(d.prop)||a.constructor&&a.constructor.prototype&&a.constructor.prototype.hasOwnProperty(d.prop))&&(a[c]=this.getInjectedValue(d,c))}return"function"!=typeof a.postConstruct||b||a.postConstruct(),this},getInjectedValue:function(a,b){var c,d=a.value;return a.cl&&(a.singleton?(a.value||(k(b,a.cl),a.value=this.instantiate(a.cl),c=a.value),d=a.value):(k(b,a.cl),d=this.instantiate(a.cl),c=d)),c&&(l(b,c),this.inject(c)),d},createInstance:function(){var a=this.instantiate.apply(this,arguments);return this.inject(a),a},getValueFromClass:function(b){for(var c in this.mappings)if(this.mappings.hasOwnProperty(c)){var d=this.mappings[c];if(d.cl===b)return d.singleton?(d.value||(d.value=this.createInstance.apply(this,arguments)),d.value):this.createInstance.apply(this,arguments)}if(this.parent)return this.parent.getValueFromClass.apply(this.parent,arguments);throw new Error(a.InjectorError.NO_MAPPING_FOUND)},dispose:function(){this.mappings={}}},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new Error("Error, you must bind a function.");var c=Array.prototype.slice.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(Array.prototype.slice.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(Array.prototype.slice.call(arguments)))};return d}),"function"==typeof define&&"undefined"!=typeof define.amd&&define("infuse",a),"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=a),"undefined"!=typeof exports&&(exports=a)}(this.infuse=this.infuse||{}),function(a){"use strict";a.events={},a.events.version="0.5.6",Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new Error("Error, you must bind a function.");var c=Array.prototype.slice.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(Array.prototype.slice.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(Array.prototype.slice.call(arguments)))};return d}),a.Event=function(b,c,d,e){var f=a.Event.createGenericEvent(b,d,e);return null!==c&&void 0!==c&&(f.params=c),f.isCloned=!1,f.clone=this.clone.bind(f),f.isIE9orIE10=this.isIE9orIE10,f.isDefaultPrevented=this.isDefaultPrevented,(this.isIE9orIE10()||!f.preventDefault||void 0===f.getDefaultPrevented&&void 0===f.defaultPrevented)&&(f.preventDefault=this.preventDefault.bind(f)),this.isIE9orIE10()&&(f.IE9or10PreventDefault=!1),f},a.Event.prototype.clone=function(){var b=a.Event.createGenericEvent(this.type,this.bubbles,this.cancelable);return b.params=this.params,b.isCloned=!0,b.clone=this.clone,b.isDefaultPrevented=this.isDefaultPrevented,b.isIE9orIE10=this.isIE9orIE10,this.isIE9orIE10()&&(b.IE9or10PreventDefault=this.IE9or10PreventDefault),b},a.Event.prototype.preventDefault=function(){return this.cancelable?(this.isIE9orIE10()?this.IE9or10PreventDefault=!0:this.defaultPrevented=!0,this):!1},a.Event.prototype.isDefaultPrevented=function(){return this.cancelable?this.isIE9orIE10()?this.IE9or10PreventDefault:void 0!==this.defaultPrevented?this.defaultPrevented:void 0!==this.getDefaultPrevented?this.getDefaultPrevented():!1:!1},a.Event.createGenericEvent=function(a,c,d){var e;return c=void 0!==c?c:!0,"object"==typeof document&&document.createEvent?(e=document.createEvent("Event"),e.initEvent(a,!!c,!!d)):"object"==typeof document&&document.createEventObject?(e=document.createEventObject(),e.type=a,e.bubbles=!!c,e.cancelable=!!d):e=new b(a,!!c,!!d),e},a.Event.prototype.isIE9orIE10=function(){return"object"!=typeof document?!1:void 0!==document.body.style.scrollbar3dLightColor&&void 0!==document.body.style.opacity||void 0!==document.body.style.msTouchAction},a.Event.prototype.toString=function(){return"[soma.Event]"};var b=function(a,b,c){this.type=a,this.bubbles=!!b,this.cancelable=!!c,this.defaultPrevented=!1,this.currentTarget=null,this.target=null};a.EventDispatcher=function(){this.listeners=[]},a.EventDispatcher.prototype.addEventListener=function(a,b,c){if(this.listeners&&a&&b){isNaN(c)&&(c=0);for(var d=0;d<this.listeners.length;d++){var e=this.listeners[d];if(e.type===a&&e.listener===b)return}this.listeners.push({type:a,listener:b,priority:c,scope:this})}},a.EventDispatcher.prototype.removeEventListener=function(a,b){if(this.listeners&&a&&b)for(var c=this.listeners.length;c-->0;){var d=this.listeners[c];d.type===a&&d.listener===b&&this.listeners.splice(c,1)}},a.EventDispatcher.prototype.hasEventListener=function(a){if(!this.listeners||!a)return!1;for(var b=0,c=this.listeners.length;c>b;++b){var d=this.listeners[b];if(d.type===a)return!0}return!1},a.EventDispatcher.prototype.dispatchEvent=function(a){if(!this.listeners||!a)throw new Error("Error in EventDispatcher (dispatchEvent), one of the parameters is null or undefined.");var b,c=[];for(b=0;b<this.listeners.length;b++){var d=this.listeners[b];d.type===a.type&&c.push(d)}for(c.sort(function(a,b){return b.priority-a.priority}),b=0;b<c.length;b++)c[b].listener.apply(a.srcElement?a.srcElement:a.currentTarget,[a]);return!a.isDefaultPrevented()},a.EventDispatcher.prototype.dispatch=function(b,c,d,e){if(!this.listeners||!b||""===b)throw new Error("Error in EventDispatcher (dispatch), one of the parameters is null or undefined.");var f=new a.Event(b,c,d,e);return this.dispatchEvent(f),f},a.EventDispatcher.prototype.dispose=function(){this.listeners=null},a.EventDispatcher.prototype.toString=function(){return"[soma.EventDispatcher]"},"function"==typeof define&&"undefined"!=typeof define.amd&&define("soma-events",a),"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=a),"undefined"!=typeof exports&&(exports=a)}(this.soma=this.soma||{});var plugins=[];soma.plugins=soma.plugins||{},soma.plugins.add=function(a){plugins.push(a)},soma.plugins.remove=function(a){for(var b=plugins.length-1,c=0;b>=c;b--)a===plugins[b]&&plugins.splice(b,1)},soma.Application=soma.extend({constructor:function(){function a(){b.injector=new infuse.Injector(b.dispatcher),b.dispatcher=new soma.EventDispatcher,b.injector.mapValue("injector",b.injector),b.injector.mapValue("instance",b),b.injector.mapValue("dispatcher",b.dispatcher),b.injector.mapClass("mediators",Mediators,!0),b.mediators=b.injector.getValue("mediators"),b.injector.mapClass("commands",Commands,!0),b.commands=b.injector.getValue("commands");for(var a=0,c=plugins.length;c>a;a++)b.createPlugin(plugins[a])}var b=this;a.bind(this)(),this.init(),this.start()},createPlugin:function(){if(0===arguments.length||!arguments[0])throw new Error("Error creating a plugin, plugin class is missing.");for(var a=infuse.getConstructorParams(arguments[0]),b=[arguments[0]],c=0;c<a.length;c++)(this.injector.hasMapping(a[c])||this.injector.hasInheritedMapping(a[c]))&&b.push(this.injector.getValue(a[c]));for(var d=1;d<arguments.length;d++)b.push(arguments[d]);return this.injector.createInstance.apply(this.injector,b)},init:function(){},start:function(){},dispose:function(){this.injector&&(this.injector.removeMapping("injector"),this.injector.removeMapping("dispatcher"),this.injector.removeMapping("mediators"),this.injector.removeMapping("commands"),this.injector.removeMapping("instance")),this.injector&&this.injector.dispose(),this.dispatcher&&this.dispatcher.dispose(),this.mediators&&this.mediators.dispose(),this.commands&&this.commands.dispose(),this.injector=void 0,this.dispatcher=void 0,this.mediators=void 0,this.commands=void 0,this.instance=void 0}});var Mediators=soma.extend({constructor:function(){this.injector=null,this.dispatcher=null},create:function(a,b){if(!a||"function"!=typeof a)throw new Error("Error creating a mediator, the first parameter must be a function.");if(void 0===b||null===b)throw new Error("Error creating a mediator, the second parameter cannot be undefined or null.");var c=[],d=[];b.length>0?c=b:c.push(b);for(var e=0,f=c.length;f>e;e++){var g=this.injector.createChild();g.mapValue("target",c[e]);var h=g.createInstance(a);if(1===c.length)return h;d.push(h)}return d},dispose:function(){this.injector=void 0,this.dispatcher=void 0}}),Commands=soma.extend({constructor:function(){this.boundHandler=this.handler.bind(this),this.dispatcher=null,this.injector=null,this.list={}},has:function(a){return null!==this.list[a]&&void 0!==this.list[a]},get:function(a){return this.has(a)?this.list[a]:void 0},getAll:function(){var a={};for(var b in this.list)this.list.hasOwnProperty(b)&&(a[b]=this.list[b]);return a},add:function(a,b){if("string"!=typeof a)throw new Error("Error adding a command, the first parameter must be a string.");if("function"!=typeof b)throw new Error('Error adding a command with the name "'+b+'", the second parameter must be a function, and must contain an "execute" public method.');if(this.has(a))throw new Error('Error adding a command with the name: "'+a+'", already registered.');this.list[a]=b,this.addInterceptor(a)},remove:function(a){this.has(a)&&(this.list[a]=void 0,delete this.list[a],this.removeInterceptor(a))},addInterceptor:function(a){this.dispatcher.addEventListener(a,this.boundHandler,-Number.MAX_VALUE)},removeInterceptor:function(a){this.dispatcher.removeEventListener(a,this.boundHandler)},handler:function(a){a.isDefaultPrevented&&!a.isDefaultPrevented()&&this.executeCommand(a)},executeCommand:function(a){var b=a.type;if(this.has(b)){var c=this.injector.createInstance(this.list[b]);if(!c.hasOwnProperty("execute")&&"function"===c.execute)throw new Error("Error in "+this+" Command "+c+" must contain an execute public method.");c.execute(a)}},dispose:function(){for(var a in this.list)this.list.hasOwnProperty(a)&&this.remove(a);this.boundHandler=void 0,this.dispatcher=void 0,this.injector=void 0,this.list=void 0}});soma.EventDispatcher.extend=function(a){return soma.inherit(soma.EventDispatcher,a)},soma.Event.extend=function(a){return soma.inherit(soma.Event,a)},infuse.Injector.extend=function(a){return soma.inherit(infuse.Injector,a)},function(a){"use strict";a.version="2.0.4","function"==typeof define&&"undefined"!=typeof define.amd&&define("soma",a),"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=a:window.soma=a}(this.soma=this.soma||{},this.infuse),soma.applyProperties=function(a,b,c,d){if("[object Array]"===Object.prototype.toString.apply(d))for(var e=0,f=d.length;f>e;e++)(void 0===a[d[e]]||null===a[d[e]])&&(a[d[e]]=c&&"function"==typeof b[d[e]]?b[d[e]].bind(b):b[d[e]]);else for(var g in b)a[g]=c&&"function"==typeof b[g]?b[g].bind(b):b[g]},soma.augment=function(a,b,c){if(b.prototype&&a.prototype)if("[object Array]"===Object.prototype.toString.apply(c))for(var d=0,e=c.length;e>d;d++)a.prototype[c[d]]||(a.prototype[c[d]]=b.prototype[c[d]]);else for(var f in b.prototype)a.prototype[f]||(a.prototype[f]=b.prototype[f])},soma.inherit=function(a,b){var c;c=b&&b.hasOwnProperty("constructor")?b.constructor:function(){return a.apply(this,arguments)};var d=function(){};return d.prototype=a.prototype,c.prototype=new d,b&&soma.applyProperties(c.prototype,b),c.prototype.constructor=c,c.parent=a.prototype,c.extend=function(a){return soma.inherit(c,a)},c},soma.extend=function(a){return soma.inherit(function(){},a)};
//# sourceMappingURL=soma.min.js.map